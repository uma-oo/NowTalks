<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>API Load Test</title>
</head>

<body>
    <h2>API Load Test - Check Console</h2>
    <script>
        const totalRequests = 10000;
        const apiUrl = 'http://localhost:8080/api/user/register'; // Change to your actual endpoint
        const logoutUrl = 'http://localhost:8080/api/user/logout'
        let names = []
        const total_requests = []
        // console.log(names);
        function createNames(size) {
            for (let i = 0; i < size; i++) {
                names.push(`oumayma${i}`)
            }
            return names
        }
        function sendRequest(index, name) {
            const nickname = `${name}`;
            const email = `${nickname}@gmail.com`;

            const payload = {
                nickname: nickname,
                age: 25,
                gender: "Female",
                firstname: "oumayma",
                lastname: "ELFAHSI",
                email: email,
                password: `Abcd@2024${nickname}`,
                password2: `Abcd@2024${nickname}`
            };

            fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            }).then(response => {
                console.log(`Request ${index}: Status ${response.status}`);
                return response.json()
            }).catch(error => {
                console.error(`Request ${index} failed:`, error);
            });
        }


        function logout() {
            fetch(logoutUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
            }).then(response => {
                console.log(`Request ${index}: Status ${response.status}, data ${response.json()}`);
                return response.json()
            }).catch(error => {
                console.error(`Request ${index} failed:`, error);
            });
        }
        async function run() {
            const names = createNames(totalRequests);
            for (let i = 0; i < totalRequests; i++) {
                await sendRequest(i, names[i]);
                await logout(i);
            }
        }

        run();
    </script>
</body>

</html>